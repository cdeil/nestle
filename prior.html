

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>The Prior Transform &mdash; nestle 0.1.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/gallery.css" type="text/css" />
  

  
    <link rel="top" title="nestle 0.1.0 documentation" href="index.html"/>
        <link rel="next" title="Stopping Criterion" href="stopping.html"/>
        <link rel="prev" title="Gaussian Shells" href="examples/plot_shells.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="index.html" class="fa fa-home"> nestle</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul class="current">
<li class="toctree-l1"><a class="reference internal" href="examples/index.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="examples/plot_eggbox.html">Eggbox</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/plot_ellipsoids.html">Bounding Ellipsoids</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/plot_line.html">Line</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/plot_shells.html">Gaussian Shells</a></li>
</ul>
</li>
<li class="toctree-l1 current"><a class="current reference internal" href="">The Prior Transform</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#uniform-priors">Uniform priors</a></li>
<li class="toctree-l2"><a class="reference internal" href="#non-uniform-priors">Non-uniform priors</a></li>
<li class="toctree-l2"><a class="reference internal" href="#why">Why?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="stopping.html">Stopping Criterion</a><ul>
<li class="toctree-l2"><a class="reference internal" href="stopping.html#estimated-remaining-evidence">Estimated remaining evidence</a></li>
<li class="toctree-l2"><a class="reference internal" href="stopping.html#declining-weight-of-saved-samples">Declining weight of saved samples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="devdocs.html">Developers&#8217; Docs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="devdocs.html#running-tests">Running tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="devdocs.html#building-the-documentation">Building the documentation</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="index.html">nestle</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>The Prior Transform</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/prior.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="the-prior-transform">
<h1>The Prior Transform<a class="headerlink" href="#the-prior-transform" title="Permalink to this headline">¶</a></h1>
<p>The <a class="reference internal" href="api.html#nestle.sample" title="nestle.sample"><tt class="xref py py-obj docutils literal"><span class="pre">nestle.sample</span></tt></a> function takes two user-defined functions as
inputs. The first function should give the natural logarithm of the
likelihood function of interest. The second function is a &#8220;prior
transform.&#8221; <em>What&#8217;s up with that?</em></p>
<p>The prior transform function is used to specify the Bayesian prior for
the problem, in a round-about way. It is a transformation from a space
where variables are independently and uniformly distributed between 0
and 1 to the parameter space of interest. For independent parameters,
this would be the product of the <a class="reference external" href="https://en.wikipedia.org/wiki/Quantile_function">inverse cumulative distribution
function</a> (also
known as the <em>percent point function</em> or <em>quantile function</em>) for each
parameter.</p>
<div class="section" id="uniform-priors">
<h2>Uniform priors<a class="headerlink" href="#uniform-priors" title="Permalink to this headline">¶</a></h2>
<p>This is easier to illustrate with a concrete example.  Suppose we
wanted a uniform prior in the range [-5, 5.) in all variables:</p>
<div class="math">
\[\begin{split}p(x) \propto \left\{
             \begin{array}{ll}
               1 \quad -5 \le x &lt; 5\\
               0 \quad {\rm otherwise}
             \end{array}
           \right.\end{split}\]</div>
<p>The prior transform would be:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">prior_transform</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">10.</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="mf">5.</span>
</pre></div>
</div>
<p>because if <tt class="docutils literal"><span class="pre">x</span></tt> is an array of numbers between 0 and 1, the result
will be an array of numbers between -5 and 5.</p>
<p>For a slightly more complex example, suppose we have problem with two
variables where the prior on the first variable is a uniform
distribution between -1 and 1 and the prior on the second variable is
a uniform distribution between -10 and 10. The prior transform would
be:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">prior_transform</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">-</span> <span class="mf">1.</span><span class="p">,</span> <span class="mf">20.</span> <span class="o">*</span> <span class="n">x</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">-</span> <span class="mf">10.</span><span class="p">])</span>
</pre></div>
</div>
<p>or equivalently:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">prior_transform</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">2.</span><span class="p">,</span> <span class="mf">20.</span><span class="p">])</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">10.</span><span class="p">])</span>
</pre></div>
</div>
<p>Incidentally, the simplest possible prior to define would be a uniform
distribution between 0 and 1 in all parameters, for which the
transform would be <tt class="docutils literal"><span class="pre">lambda</span> <span class="pre">x:</span> <span class="pre">x</span></tt>.</p>
</div>
<div class="section" id="non-uniform-priors">
<h2>Non-uniform priors<a class="headerlink" href="#non-uniform-priors" title="Permalink to this headline">¶</a></h2>
<p>Suppose we wish to specify a normal distribution for our prior, in two
dimensions. We can use the inverse cumulative distribution function
for the normal distribution, <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/generated/scipy.special.ndtri.html#scipy.special.ndtri" title="(in SciPy v0.16.0)"><tt class="xref py py-obj docutils literal"><span class="pre">scipy.special.ndtri</span></tt></a>:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">from</span> <span class="nn">scipy.special</span> <span class="kn">import</span> <span class="n">ndtri</span>

<span class="n">prior_transform</span> <span class="o">=</span> <span class="n">ndtri</span>
</pre></div>
</div>
<p>This specifies a normal distribution with mean 0 and standard
deviation 1 in all dimensions. To specify a different mean and
standard deviation, simply transform the output:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="k">def</span> <span class="nf">prior_transform</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">mu</span> <span class="o">+</span> <span class="n">sigma</span> <span class="o">*</span> <span class="n">ndtri</span><span class="p">(</span><span class="n">x</span><span class="p">)</span>
</pre></div>
</div>
<p>where <tt class="docutils literal"><span class="pre">mu</span></tt> is an array giving the mean in each dimension and
<tt class="docutils literal"><span class="pre">sigma</span></tt> is an array giving the standard deviation in each dimension.</p>
<p>The distributions in <a class="reference external" href="http://docs.scipy.org/doc/scipy/reference/stats.html#module-scipy.stats" title="(in SciPy v0.16.0)"><tt class="xref py py-obj docutils literal"><span class="pre">scipy.stats</span></tt></a> (particularly the <tt class="docutils literal"><span class="pre">ppf</span></tt> method)
might be particuarly useful in constructing more complex priors.</p>
</div>
<div class="section" id="why">
<h2>Why?<a class="headerlink" href="#why" title="Permalink to this headline">¶</a></h2>
<p><strong>Why not combine the prior and likelihood in a single function (giving
the posterior) as in, e.g., emcee?</strong></p>
<p>Unlike traditional MCMC, nested sampling starts by randomly sampling
from the entire parameter space. This is not possible without
specifying some sort of contraints on the parameters. Thus the user
would still have to specify bounds on all the parameters. You could
use <a class="reference internal" href="api.html#nestle.sample" title="nestle.sample"><tt class="xref py py-obj docutils literal"><span class="pre">nestle.sample</span></tt></a> this way: pass a &#8220;loglikelihood&#8221; function that in
fact returns the log of the posterior, and then specify a prior
transform that is uniform in some parameter range (as illustrated in
the first example). This will give valid results.</p>
<p>However, there are a couple advantages to specifying the prior as a
transform rather than simply as bounds. First, it naturally allows
priors that extend to infinity but have finite integrals, such as the
normal distribution illustrated above. Second, assuming the prior
transform is computationally cheap, this lets us cheaply draw samples
according to the prior. We will (proportionally) avoid evaluating the
likelihood in regions we know to have small prior values. (This
preferential sampling is accounted for in the results.)</p>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="stopping.html" class="btn btn-neutral float-right" title="Stopping Criterion">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
        <a href="examples/plot_shells.html" class="btn btn-neutral" title="Gaussian Shells"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014-2015, Kyle Barbary and contributors.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>