

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Nestle &mdash; nestle 0.1.0 documentation</title>
  

  
  

  
  <link href='https://fonts.googleapis.com/css?family=Lato:400,700,400italic,700italic|Roboto+Slab:400,700|Inconsolata:400,700&subset=latin,cyrillic' rel='stylesheet' type='text/css'>

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  

  
    <link rel="stylesheet" href="_static/gallery.css" type="text/css" />
  

  
    <link rel="top" title="nestle 0.1.0 documentation" href="#"/>
        <link rel="next" title="Examples" href="examples/index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">

    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-nav-search">
        
          <a href="#" class="fa fa-home"> nestle</a>
        
        
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
        
          
          
              <ul>
<li class="toctree-l1"><a class="reference internal" href="examples/index.html">Examples</a><ul>
<li class="toctree-l2"><a class="reference internal" href="examples/plot_eggbox.html">Eggbox</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/plot_ellipsoids.html">Bounding Ellipsoids</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/plot_line.html">Line</a></li>
<li class="toctree-l2"><a class="reference internal" href="examples/plot_shells.html">Gaussian Shells</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="prior.html">The Prior Transform</a><ul>
<li class="toctree-l2"><a class="reference internal" href="prior.html#uniform-priors">Uniform priors</a></li>
<li class="toctree-l2"><a class="reference internal" href="prior.html#non-uniform-priors">Non-uniform priors</a></li>
<li class="toctree-l2"><a class="reference internal" href="prior.html#why">Why?</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="stopping.html">Stopping Criterion</a><ul>
<li class="toctree-l2"><a class="reference internal" href="stopping.html#estimated-remaining-evidence">Estimated remaining evidence</a></li>
<li class="toctree-l2"><a class="reference internal" href="stopping.html#declining-weight-of-saved-samples">Declining weight of saved samples</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="api.html">API</a></li>
<li class="toctree-l1"><a class="reference internal" href="devdocs.html">Developers&#8217; Docs</a><ul>
<li class="toctree-l2"><a class="reference internal" href="devdocs.html#running-tests">Running tests</a></li>
<li class="toctree-l2"><a class="reference internal" href="devdocs.html#building-the-documentation">Building the documentation</a></li>
</ul>
</li>
</ul>

          
        
      </div>
      &nbsp;
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" role="navigation" aria-label="top navigation">
        <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
        <a href="#">nestle</a>
      </nav>


      
      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href="#">Docs</a> &raquo;</li>
      
    <li>Nestle</li>
      <li class="wy-breadcrumbs-aside">
        
          <a href="_sources/index.txt" rel="nofollow"> View page source</a>
        
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document">
            
  <div class="section" id="nestle">
<h1>Nestle<a class="headerlink" href="#nestle" title="Permalink to this headline">¶</a></h1>
<p>/ˈnesəl/ <em>(rhymes with &#8220;wrestle&#8221;)</em></p>
<a class="reference external image-reference" href="examples/plot_ellipsoids.html"><img alt="_images/sphx_glr_plot_ellipsoids_001.png" class="align-right" src="_images/sphx_glr_plot_ellipsoids_001.png" style="width: 280px;" /></a>
<p>Pure Python, MIT-licensed implementation of nested sampling algorithms.</p>
<p><a class="reference external" href="https://en.wikipedia.org/wiki/Nested_sampling_algorithm">Nested Sampling</a> is a
computational approach for integrating posterior probability in order
to compare models in Bayesian statistics. It is similar to Markov
Chain Monte Carlo (MCMC) in that it generates samples that can be used
to estimate the posterior probability distribution. Unlike MCMC, the
nature of the sampling also allows one to calculate the integral of
the distribution. It also happens to be a pretty good method for robustly
finding global maxima.</p>
<div class="section" id="install">
<h2>Install<a class="headerlink" href="#install" title="Permalink to this headline">¶</a></h2>
<p>Nestle is compatible with both Python and Legacy Python (formerly known as Python 2). It requires numpy 1.6+ and, optionally, scipy. Install with pip:</p>
<div class="highlight-python"><div class="highlight"><pre>pip install nestle
</pre></div>
</div>
<p>For the latest development version, see <a class="reference external" href="http://github.com/kbarbary/nestle">http://github.com/kbarbary/nestle</a>.</p>
</div>
<div class="section" id="getting-started">
<h2>Getting started<a class="headerlink" href="#getting-started" title="Permalink to this headline">¶</a></h2>
<p>The following is a simple but complete example of using Nestle to
sample the parameters of a line given three data points with
uncertainties:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">numpy</span> <span class="kn">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">nestle</span>

<span class="n">data_x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.</span><span class="p">,</span> <span class="mf">2.</span><span class="p">,</span> <span class="mf">3.</span><span class="p">])</span>
<span class="n">data_y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">1.4</span><span class="p">,</span> <span class="mf">1.7</span><span class="p">,</span> <span class="mf">4.1</span><span class="p">])</span>
<span class="n">data_yerr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.15</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">])</span>

<span class="c"># Define a likelihood function</span>
<span class="k">def</span> <span class="nf">loglike</span><span class="p">(</span><span class="n">theta</span><span class="p">):</span>
    <span class="n">y</span> <span class="o">=</span> <span class="n">theta</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="n">data_x</span> <span class="o">+</span> <span class="n">theta</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">chisq</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(((</span><span class="n">data_y</span> <span class="o">-</span> <span class="n">y</span><span class="p">)</span> <span class="o">/</span> <span class="n">data_yerr</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>
    <span class="k">return</span> <span class="o">-</span><span class="n">chisq</span> <span class="o">/</span> <span class="mf">2.</span>

<span class="c"># Define a function mapping the unit cube to the prior space.</span>
<span class="c"># This function defines a flat prior in [-5., 5.) in both dimensions.</span>
<span class="k">def</span> <span class="nf">prior_transform</span><span class="p">(</span><span class="n">x</span><span class="p">):</span>
    <span class="k">return</span> <span class="mf">10.0</span> <span class="o">*</span> <span class="n">x</span> <span class="o">-</span> <span class="mf">5.0</span>

<span class="c"># Run nested sampling.</span>
<span class="n">result</span> <span class="o">=</span> <span class="n">nestle</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">loglike</span><span class="p">,</span> <span class="n">prior_trasform</span><span class="p">,</span> <span class="mi">2</span><span class="p">)</span>

<span class="n">result</span><span class="o">.</span><span class="n">logz</span>     <span class="c"># log evidence</span>
<span class="n">result</span><span class="o">.</span><span class="n">logzerr</span>  <span class="c"># numerical (sampling) error on logz</span>
<span class="n">result</span><span class="o">.</span><span class="n">samples</span>  <span class="c"># array of sample parameters</span>
<span class="n">result</span><span class="o">.</span><span class="n">weights</span>  <span class="c"># array of weights associated with each sample</span>
</pre></div>
</div>
<ul class="simple">
<li>See <a class="reference internal" href="examples/index.html"><em>Examples</em></a> for more detailed examples.</li>
<li>See <a class="reference internal" href="prior.html"><em>The Prior Transform</em></a> for more information on the <tt class="docutils literal"><span class="pre">prior_tranform</span></tt> function.</li>
<li>See <a class="reference internal" href="stopping.html"><em>Stopping Criterion</em></a> for discussion on when the algorithm terminates.</li>
<li>See the <a class="reference internal" href="api.html"><em>API</em></a> page for detailed API documentation.</li>
</ul>
</div>
<div class="section" id="available-methods">
<h2>Available methods<a class="headerlink" href="#available-methods" title="Permalink to this headline">¶</a></h2>
<p>The trick in nested sampling is to, at each step in the algorithm,
<em>efficiently</em> choose a new point in parameter space drawn with
<em>uniform probability</em> from the parameter space with likelihood greater
than the current likelihood constraint. The different methods all use
the current set of active points as an indicator of where the target
parameter space lies, but differ in how they select new points from
it.</p>
<div class="section" id="mcmc-exploration-method-classic">
<h3>MCMC exploration (<tt class="xref py py-obj docutils literal"><span class="pre">method='classic'</span></tt>)<a class="headerlink" href="#mcmc-exploration-method-classic" title="Permalink to this headline">¶</a></h3>
<p>This is close to the method described in Skilling (2004).</p>
</div>
<div class="section" id="single-ellipsoid-method-single">
<h3>Single ellipsoid (<tt class="xref py py-obj docutils literal"><span class="pre">method='single'</span></tt>)<a class="headerlink" href="#single-ellipsoid-method-single" title="Permalink to this headline">¶</a></h3>
<p>This is the method described by Mukherjee, Parkinson &amp; Liddle (2006).
Determines a single ellipsoid that bounds all active points, enlarges
the ellipsoid by a user-settable factor, and selects a new
point at random from within the ellipsoid. The enlargement factor is designed to
ensure that the high-likelihood region is completely enclosed in the ellipsoid.</p>
</div>
<div class="section" id="multiple-ellipsoids-method-multi">
<h3>Multiple ellipsoids (<tt class="xref py py-obj docutils literal"><span class="pre">method='multi'</span></tt>)<a class="headerlink" href="#multiple-ellipsoids-method-multi" title="Permalink to this headline">¶</a></h3>
<p>This is the method first described in Shaw, Bridges &amp; Hobson (2007) and
implemented in the MultiNest software (Feroz, Hobson &amp; Bridges 2009).</p>
<p>In cases where the posterior is multi-modal, the single-ellipsoid
method can be extremely inefficient: In such situations, there are
clusters of active points on separate high-likelihood regions
separated by regions of lower likelihood.  Bounding all points in a
single ellipsoid means that the ellipsoid includes the
lower-likelihood regions we wish to avoid sampling from.</p>
<p>The solution is to detect these clusters and bound them in separate
ellipsoids.  For this, we use a recursive process where we perform
K-means clustering with K=2. If the resulting two ellipsoids have a
significantly lower total volume than the parent ellipsoid (less than
half), we accept the split and repeat the clustering and volume test
on each of the two subset of points. This process continues
recursively. Alternatively, if the total ellipse volume is
significantly greater than expected (based on the expected density of
points) this indicates that there may be more than two clusters and
that K=2 was not an appropriate cluster division. We therefore still
try to subdivide the clusters recursively. However, we still only
accept the final split into N clusters if the total volume decrease is
significant.</p>
</div>
</div>
<div class="section" id="references">
<h2>References<a class="headerlink" href="#references" title="Permalink to this headline">¶</a></h2>
<p>Feroz, Hobson &amp; Bridges 2009. MultiNest: an efficient and robust
Bayesian inference tool for cosmology and particle physics. <em>MNRAS</em>,
<strong>398</strong>, <a class="reference external" href="http://adsabs.harvard.edu/abs/2009MNRAS.398.1601F">1601</a>.</p>
<p>Mukherjee, Parkinson &amp; Liddle 2006. A Nested sampling algorithm for
cosmological model selection. <em>ApJ</em>, <strong>638</strong>, <a class="reference external" href="http://adsabs.harvard.edu/abs/2006ApJ...638L..51M">L51</a>.</p>
<p>Shaw, Bridges &amp; Hobson 2007. Efficient Bayesian inference for
multimodal problems in cosmology. <em>MNRAS</em>, <strong>378</strong>, <a class="reference external" href="http://adsabs.harvard.edu/abs/2007MNRAS.378.1365S">1365</a>.</p>
<p>Silvia &amp; Skilling 2006. Data Analysis: A Bayesian Tutorial, 2nd
Edition. Oxford University Press.</p>
<p>Skilling, J. 2004. Nested Sampling. In <em>Maximum entropy and Bayesian
methods in science and engineering</em> (ed. G. Erickson, J.T. Rychert,
C.R. Smith). <em>AIP Conf. Proc.</em>, <strong>735</strong>,
<a class="reference external" href="http://adsabs.harvard.edu/abs/2004AIPC..735..395S">395</a>.</p>
<p>See also <a class="reference external" href="http://www.inference.phy.cam.ac.uk/bayesys/">http://www.inference.phy.cam.ac.uk/bayesys/</a>.</p>
</div>
<div class="section" id="citation">
<h2>Citation<a class="headerlink" href="#citation" title="Permalink to this headline">¶</a></h2>
<p>If you use Nestle in your work, please cite the github repository and the
relevant references listed above.</p>
<div class="toctree-wrapper compound">
</div>
</div>
</div>


          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
        <a href="examples/index.html" class="btn btn-neutral float-right" title="Examples">Next <span class="fa fa-arrow-circle-right"></span></a>
      
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        &copy; Copyright 2014-2015, Kyle Barbary and contributors.
    </p>
  </div>

  Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a <a href="https://github.com/snide/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
  
</footer>
        </div>
      </div>

    </section>

  </div>
  


  

    <script type="text/javascript">
        var DOCUMENTATION_OPTIONS = {
            URL_ROOT:'./',
            VERSION:'0.1.0',
            COLLAPSE_INDEX:false,
            FILE_SUFFIX:'.html',
            HAS_SOURCE:  true
        };
    </script>
      <script type="text/javascript" src="_static/jquery.js"></script>
      <script type="text/javascript" src="_static/underscore.js"></script>
      <script type="text/javascript" src="_static/doctools.js"></script>
      <script type="text/javascript" src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script>

  

  
  
    <script type="text/javascript" src="_static/js/theme.js"></script>
  

  
  
  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.StickyNav.enable();
      });
  </script>
   

</body>
</html>